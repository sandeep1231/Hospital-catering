{"ast":null,"code":"import { ApiService } from '../../services/api.service';\nimport { ToastService } from '../../services/toast.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/api.service\";\nimport * as i2 from \"../../services/toast.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction AdminUsersComponent_option_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const r_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", r_r3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(r_r3);\n  }\n}\nfunction AdminUsersComponent_div_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵtext(1, \"Loading...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AdminUsersComponent_tr_53_option_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const r_r6 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", r_r6);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(r_r6);\n  }\n}\nfunction AdminUsersComponent_tr_53_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"input\", 29);\n    i0.ɵɵlistener(\"ngModelChange\", function AdminUsersComponent_tr_53_Template_input_ngModelChange_2_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const u_r4 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(u_r4.name = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\")(6, \"select\", 30);\n    i0.ɵɵlistener(\"ngModelChange\", function AdminUsersComponent_tr_53_Template_select_ngModelChange_6_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const u_r4 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(u_r4.role = $event);\n    });\n    i0.ɵɵtemplate(7, AdminUsersComponent_tr_53_option_7_Template, 2, 2, \"option\", 17);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"td\")(9, \"div\", 31)(10, \"span\", 32);\n    i0.ɵɵtext(11, \"New pass\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"input\", 33);\n    i0.ɵɵlistener(\"ngModelChange\", function AdminUsersComponent_tr_53_Template_input_ngModelChange_12_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const u_r4 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(u_r4._newPassword = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"div\", 34)(14, \"button\", 35);\n    i0.ɵɵlistener(\"click\", function AdminUsersComponent_tr_53_Template_button_click_14_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const u_r4 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.update(u_r4));\n    });\n    i0.ɵɵtext(15, \"Save\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"button\", 36);\n    i0.ɵɵlistener(\"click\", function AdminUsersComponent_tr_53_Template_button_click_16_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const u_r4 = restoredCtx.$implicit;\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.remove(u_r4));\n    });\n    i0.ɵɵtext(17, \"Delete\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const u_r4 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", u_r4.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(u_r4.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", u_r4.role);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.roles);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", u_r4._newPassword);\n  }\n}\nexport let AdminUsersComponent = /*#__PURE__*/(() => {\n  class AdminUsersComponent {\n    constructor(api, toast) {\n      this.api = api;\n      this.toast = toast;\n      this.users = [];\n      this.q = '';\n      this.form = {\n        name: '',\n        email: '',\n        password: '',\n        role: 'user'\n      };\n      this.roles = ['admin', 'dietician', 'vendor', 'kitchen', 'delivery', 'user'];\n      this.loading = false;\n    }\n    ngOnInit() {\n      this.load();\n    }\n    load() {\n      this.loading = true;\n      const params = {};\n      if (this.q) params.q = this.q;\n      this.api.get('/users', params).subscribe(res => {\n        this.users = res || [];\n        this.loading = false;\n      }, err => {\n        this.toast.error('Failed to load users');\n        this.loading = false;\n      });\n    }\n    create(e) {\n      e.preventDefault();\n      if (!this.form.name || !this.form.email || !this.form.password) {\n        this.toast.error('All fields are required');\n        return;\n      }\n      this.api.post('/users', this.form).subscribe(res => {\n        this.toast.success('User created');\n        this.form = {\n          name: '',\n          email: '',\n          password: '',\n          role: 'user'\n        };\n        this.load();\n      }, err => {\n        this.toast.error(err?.error?.message || 'Create failed');\n      });\n    }\n    update(u) {\n      const body = {\n        name: u.name,\n        role: u.role\n      };\n      if (u._newPassword) body.password = u._newPassword;\n      this.api.put(`/users/${u._id}`, body).subscribe(() => {\n        this.toast.success('Updated');\n        this.load();\n      }, err => {\n        this.toast.error('Update failed');\n      });\n    }\n    remove(u) {\n      if (!confirm('Delete user ' + u.email + '?')) return;\n      this.api.delete(`/users/${u._id}`).subscribe(() => {\n        this.toast.success('Deleted');\n        this.load();\n      }, err => {\n        this.toast.error('Delete failed');\n      });\n    }\n    static {\n      this.ɵfac = function AdminUsersComponent_Factory(t) {\n        return new (t || AdminUsersComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.ToastService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: AdminUsersComponent,\n        selectors: [[\"app-admin-users\"]],\n        decls: 54,\n        vars: 9,\n        consts: [[1, \"d-flex\", \"align-items-center\", \"mb-3\"], [1, \"me-auto\", \"mb-0\"], [1, \"input-group\", 2, \"max-width\", \"320px\"], [\"placeholder\", \"Search users...\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"keyup.enter\"], [1, \"btn\", \"btn-outline-secondary\", 3, \"click\"], [1, \"row\", \"g-3\", \"mb-4\"], [1, \"col-12\", \"col-lg-5\"], [1, \"card\"], [1, \"card-body\"], [1, \"mb-3\"], [3, \"submit\"], [1, \"mb-2\"], [1, \"form-label\"], [\"name\", \"name\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"email\", \"name\", \"email\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"password\", \"name\", \"password\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"role\", 1, \"form-select\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [1, \"col-12\", \"col-lg-7\"], [1, \"d-flex\", \"align-items-center\", \"mb-2\"], [1, \"mb-0\", \"me-auto\"], [\"class\", \"small text-muted\", 4, \"ngIf\"], [1, \"table-responsive\"], [1, \"table\", \"align-middle\"], [2, \"width\", \"220px\"], [4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [1, \"small\", \"text-muted\"], [1, \"form-control\", \"form-control-sm\", 3, \"ngModel\", \"ngModelChange\"], [1, \"form-select\", \"form-select-sm\", 3, \"ngModel\", \"ngModelChange\"], [1, \"input-group\", \"input-group-sm\", \"mb-1\"], [1, \"input-group-text\"], [\"placeholder\", \"leave blank\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"d-flex\", \"gap-2\"], [1, \"btn\", \"btn-outline-primary\", \"btn-sm\", 3, \"click\"], [1, \"btn\", \"btn-outline-danger\", \"btn-sm\", 3, \"click\"]],\n        template: function AdminUsersComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h4\", 1);\n            i0.ɵɵtext(2, \"User Management\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"div\", 2)(4, \"input\", 3);\n            i0.ɵɵlistener(\"ngModelChange\", function AdminUsersComponent_Template_input_ngModelChange_4_listener($event) {\n              return ctx.q = $event;\n            })(\"keyup.enter\", function AdminUsersComponent_Template_input_keyup_enter_4_listener() {\n              return ctx.load();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"button\", 4);\n            i0.ɵɵlistener(\"click\", function AdminUsersComponent_Template_button_click_5_listener() {\n              return ctx.load();\n            });\n            i0.ɵɵtext(6, \"Search\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(7, \"div\", 5)(8, \"div\", 6)(9, \"div\", 7)(10, \"div\", 8)(11, \"h5\", 9);\n            i0.ɵɵtext(12, \"Create user\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(13, \"form\", 10);\n            i0.ɵɵlistener(\"submit\", function AdminUsersComponent_Template_form_submit_13_listener($event) {\n              return ctx.create($event);\n            });\n            i0.ɵɵelementStart(14, \"div\", 11)(15, \"label\", 12);\n            i0.ɵɵtext(16, \"Name\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(17, \"input\", 13);\n            i0.ɵɵlistener(\"ngModelChange\", function AdminUsersComponent_Template_input_ngModelChange_17_listener($event) {\n              return ctx.form.name = $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(18, \"div\", 11)(19, \"label\", 12);\n            i0.ɵɵtext(20, \"Email\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(21, \"input\", 14);\n            i0.ɵɵlistener(\"ngModelChange\", function AdminUsersComponent_Template_input_ngModelChange_21_listener($event) {\n              return ctx.form.email = $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(22, \"div\", 11)(23, \"label\", 12);\n            i0.ɵɵtext(24, \"Password\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(25, \"input\", 15);\n            i0.ɵɵlistener(\"ngModelChange\", function AdminUsersComponent_Template_input_ngModelChange_25_listener($event) {\n              return ctx.form.password = $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(26, \"div\", 9)(27, \"label\", 12);\n            i0.ɵɵtext(28, \"Role\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(29, \"select\", 16);\n            i0.ɵɵlistener(\"ngModelChange\", function AdminUsersComponent_Template_select_ngModelChange_29_listener($event) {\n              return ctx.form.role = $event;\n            });\n            i0.ɵɵtemplate(30, AdminUsersComponent_option_30_Template, 2, 2, \"option\", 17);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(31, \"button\", 18);\n            i0.ɵɵtext(32, \"Create\");\n            i0.ɵɵelementEnd()()()()();\n            i0.ɵɵelementStart(33, \"div\", 19)(34, \"div\", 7)(35, \"div\", 8)(36, \"div\", 20)(37, \"h5\", 21);\n            i0.ɵɵtext(38);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(39, AdminUsersComponent_div_39_Template, 2, 0, \"div\", 22);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(40, \"div\", 23)(41, \"table\", 24)(42, \"thead\")(43, \"tr\")(44, \"th\");\n            i0.ɵɵtext(45, \"Name\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(46, \"th\");\n            i0.ɵɵtext(47, \"Email\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(48, \"th\");\n            i0.ɵɵtext(49, \"Role\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(50, \"th\", 25);\n            i0.ɵɵtext(51, \"Actions\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(52, \"tbody\");\n            i0.ɵɵtemplate(53, AdminUsersComponent_tr_53_Template, 18, 5, \"tr\", 26);\n            i0.ɵɵelementEnd()()()()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngModel\", ctx.q);\n            i0.ɵɵadvance(13);\n            i0.ɵɵproperty(\"ngModel\", ctx.form.name);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngModel\", ctx.form.email);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngModel\", ctx.form.password);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngModel\", ctx.form.role);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngForOf\", ctx.roles);\n            i0.ɵɵadvance(8);\n            i0.ɵɵtextInterpolate1(\"Users (\", ctx.users.length, \")\");\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.loading);\n            i0.ɵɵadvance(14);\n            i0.ɵɵproperty(\"ngForOf\", ctx.users);\n          }\n        },\n        dependencies: [i3.NgForOf, i3.NgIf, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm],\n        styles: [\".table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{vertical-align:middle}\"]\n      });\n    }\n  }\n  return AdminUsersComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}